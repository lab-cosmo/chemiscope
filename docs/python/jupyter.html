<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Chemiscope in streamlit" href="streamlit.html"><link rel="prev" title="chemiscope functions reference" href="reference.html">
        <link rel="prefetch" href="../_static/chemiscope-icon-no-name.svg" as="image">

    <link rel="shortcut icon" href="../_static/chemiscope-icon.png"><!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>Jupyter notebooks - chemiscope 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/chemiscope.css?v=842a4e29" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-background-secondary: #f4f8ff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-background-secondary: #303d4f;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-background-secondary: #303d4f;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">chemiscope 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/chemiscope-icon-no-name.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">chemiscope 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Chemiscope</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting-started/index.html">Getting started</a><input aria-label="Toggle navigation of Getting started" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/properties.html">Introduction to structural properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/panels.html">Different panels and settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/input.html">Creating inputs with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/json-format.html">Chemiscope JSON file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/sharing.html">Sharing datasets with collaborators</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Examples</a><input aria-label="Toggle navigation of Examples" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/1-base.html">Simple chemiscope input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/2-structure_map.html">Structure-property maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/3-trajectory.html">Trajectory plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/4-colors.html">Atom property coloring and labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/5-shapes.html">Shape visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/6-explore.html">Exploring dataset with chemiscope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/7-explore-advanced.html">Advanced dataset exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/8-explore-with-metatomic.html">Using metatomic models for dataset exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/9-stk-custom-bonds.html">Using stk structures and showing custom bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/10-visualizing-biomolecules.html">Visualize biomolecules with MDAnalysis or chemfiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/11-headless.html">Headless mode</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Python module</a><input aria-label="Toggle navigation of Python module" checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cli.html">Command line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference.html"><code class="docutils literal notranslate"><span class="pre">chemiscope</span></code> functions reference</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="streamlit.html">Chemiscope in <code class="docutils literal notranslate"><span class="pre">streamlit</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="sphinx.html">Chemiscope in <code class="docutils literal notranslate"><span class="pre">sphinx</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery.html">Use with <code class="docutils literal notranslate"><span class="pre">sphinx-gallery</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../embedding.html">Chemiscope as a library</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/python/jupyter.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="jupyter-notebooks">
<span id="jupyter"></span><h1>Jupyter notebooks<a class="headerlink" href="#jupyter-notebooks" title="Link to this heading">¶</a></h1>
<p>Chemiscope can be used as a widget in Jupyter notebooks, that should work in
both Jupyter classic and JupyterLab. The widget can be created in <code class="docutils literal notranslate"><span class="pre">default</span></code>
mode (showing both a structure and a map panel), or used to display only
structures or only properties.</p>
<p>Once created, it is possible to interact with the widget using a traitlet
interface, modeled after <a class="reference external" href="http://ipywidgets.readthedocs.io">Jupyter widgets</a>.</p>
<section id="creating-a-chemiscope-widget">
<h2>Creating a chemiscope widget<a class="headerlink" href="#creating-a-chemiscope-widget" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.show">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warning_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.show" title="Link to this definition">¶</a></dt>
<dd><p>Show the dataset defined by the given <code class="docutils literal notranslate"><span class="pre">structures</span></code> and <code class="docutils literal notranslate"><span class="pre">properties</span></code> (optionally
<code class="docutils literal notranslate"><span class="pre">metadata</span></code>, <code class="docutils literal notranslate"><span class="pre">environments</span></code> and <code class="docutils literal notranslate"><span class="pre">shapes</span></code> as well) using an embedded chemiscope
visualizer inside a Jupyter notebook. These parameters have the same meaning as in
the <a class="reference internal" href="reference.html#chemiscope.create_input" title="chemiscope.create_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">chemiscope.create_input()</span></code></a> function.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mode</span></code> keyword also allows overriding the default two-panels visualization to
show only a structure panel (<code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">=</span> <span class="pre">&quot;structure&quot;</span></code>) or the map panel (<code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">=</span>
<span class="pre">&quot;map&quot;</span></code>). These modes also make it possible to view a dataset for which properties
(or structures) are not available. The widget displays warning messages, that
disappear after the specified <code class="docutils literal notranslate"><span class="pre">warning_timeout</span></code> (in ms). Set to a negative value
to disable warnings, and to zero to make them persistent. <code class="docutils literal notranslate"><span class="pre">cache_structures</span></code> is a
flag determining whether to cache structure data on the Python side to reduce the
JScript memory footprint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> – list of atomic structures. These can be <cite>chemiscope</cite> compatible
dictionaries, <a class="reference external" href="https://ase-lib.org/ase/ase/atoms.html">ase.Atoms</a>,
<a class="reference external" href="https://stk.readthedocs.io/en/stable/_autosummary/stk.BuildingBlock.html">stk.BuildingBlock</a>,
or <a class="reference external" href="https://docs.mdanalysis.org/stable/documentation_pages/core/groups.html">MDAnalysis.AtomGroup</a>
objects. See <a class="reference internal" href="reference.html#chemiscope.create_input" title="chemiscope.create_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">chemiscope.create_input()</span></code></a> for more details.</p></li>
<li><p><strong>properties</strong> (<em>dict</em>) – dictionary of properties (see
<a class="reference internal" href="reference.html#chemiscope.create_input" title="chemiscope.create_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">chemiscope.create_input()</span></code></a>)</p></li>
<li><p><strong>metadata</strong> (<em>dict</em>) – optional metadata (see <a class="reference internal" href="reference.html#chemiscope.create_input" title="chemiscope.create_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">chemiscope.create_input()</span></code></a>)</p></li>
<li><p><strong>environments</strong> (<em>list</em>) – optional list of <code class="docutils literal notranslate"><span class="pre">(structure</span> <span class="pre">id,</span> <span class="pre">atom</span> <span class="pre">id,</span> <span class="pre">cutoff)</span></code>
tuples specifying which atoms have properties attached and how far out
atom-centered environments should be drawn by default (see
<a class="reference internal" href="reference.html#chemiscope.create_input" title="chemiscope.create_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">chemiscope.create_input()</span></code></a>)</p></li>
<li><p><strong>shapes</strong> – optional dictionary of shapes (see
<a class="reference internal" href="reference.html#chemiscope.create_input" title="chemiscope.create_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">chemiscope.create_input()</span></code></a>)</p></li>
<li><p><strong>settings</strong> – optional dictionary of settings (see
<a class="reference internal" href="reference.html#chemiscope.create_input" title="chemiscope.create_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">chemiscope.create_input()</span></code></a> and the <a class="reference internal" href="../getting-started/json-format.html#json-settings"><span class="std std-ref">Settings (settings)</span></a>
section for a list of available settings)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – widget mode: <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;structure&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;map&quot;</span></code>. The
<code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code> mode shows both map and structure panels. The <code class="docutils literal notranslate"><span class="pre">&quot;structure&quot;</span></code> mode
shows only the structure panel. The <code class="docutils literal notranslate"><span class="pre">&quot;map&quot;</span></code> mode shows only the map panel.</p></li>
<li><p><strong>warning_timeout</strong> (<em>int</em>) – timeout (in ms) for warning messages. Set to a negative
value to disable warnings, and to zero to make them persistent.</p></li>
<li><p><strong>cache_structures</strong> (<em>bool</em>) – whether to cache structure data on the Python side
to reduce the JavaScript memory footprint</p></li>
</ul>
</dd>
</dl>
<p>When inside a jupyter notebook, the returned object will create a new chemiscope
visualizer displaying the dataset. The object exposes a <code class="docutils literal notranslate"><span class="pre">settings</span></code> traitlet, that
allows to modify the visualization options (possibly even linking the parameters to
another widget). Printing the value of the <code class="docutils literal notranslate"><span class="pre">settings</span></code> property is also a good way
to see a full list of the available options.</p>
<p>The returned object also have a <code class="docutils literal notranslate"><span class="pre">save</span></code> function that can be used to save the
dataset to a <code class="docutils literal notranslate"><span class="pre">.json</span></code> or <code class="docutils literal notranslate"><span class="pre">.json.gz</span></code> file to load it in the main website later.
The visualization options will be those used in the active widget, so this is also a
good way to tweak the appearance of the visualization before saving it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">chemiscope</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ase.io</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">structures</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;PCA&quot;</span><span class="p">:</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">some_data</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">widget</span> <span class="o">=</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">structures</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
<span class="c1"># display the dataset in a chemiscope visualizer inside the notebook</span>
<span class="n">widget</span>
<span class="c1"># ...</span>

<span class="c1"># NB: due to how traitlet work, you should always set the value of</span>
<span class="c1"># the `settings` property. Only the properties that are explicitly</span>
<span class="c1"># indicated will be modified.</span>
<span class="n">widget</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;map&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;symbol&quot;</span><span class="p">:</span> <span class="s2">&quot;tag&quot;</span><span class="p">}}</span>
<span class="n">widget</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;map&quot;</span><span class="p">][</span><span class="s2">&quot;symbol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;tag&quot;</span>  <span class="c1"># &lt;&lt; does nothing!</span>

<span class="c1"># Save the file for later use</span>
<span class="n">widget</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;dataset.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.show_input">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">show_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warning_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.show_input" title="Link to this definition">¶</a></dt>
<dd><p>Loads and shows the chemiscope input in <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">path</span></code> ends with <code class="docutils literal notranslate"><span class="pre">.gz</span></code>, the file is loaded as a gzip compressed JSON string.
If <code class="docutils literal notranslate"><span class="pre">path</span></code> is a file-like object, it is read as JSON input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em><em> | </em><em>Path</em><em> | </em><em>file-like</em>) – load the chemiscope input from this path or
file-like object</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – override the default settings in the input (see the
<a class="reference internal" href="../getting-started/json-format.html#json-settings"><span class="std std-ref">Settings (settings)</span></a> section for a list of available settings)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – widget mode, either <code class="docutils literal notranslate"><span class="pre">default</span></code>, <code class="docutils literal notranslate"><span class="pre">structure</span></code> or <code class="docutils literal notranslate"><span class="pre">map</span></code>.</p></li>
<li><p><strong>warning_timeout</strong> (<em>int</em>) – timeout (in ms) for warnings. Set to a negative value
to disable warnings, and to zero to make them persistent.</p></li>
<li><p><strong>cache_structures</strong> (<em>bool</em>) – whether to cache structure data on the Python side
to reduce the JScript memory footprint</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">chemiscope</span>

<span class="n">widget</span> <span class="o">=</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="s2">&quot;dataset.json&quot;</span><span class="p">)</span>

<span class="c1"># or</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;dataset.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="widget-properties-and-methods">
<h2>Widget properties and methods<a class="headerlink" href="#widget-properties-and-methods" title="Link to this heading">¶</a></h2>
<p>The widget object returned by <a class="reference internal" href="#chemiscope.show" title="chemiscope.show"><code class="xref py py-func docutils literal notranslate"><span class="pre">chemiscope.show()</span></code></a> provides traitlets to
interact with the visualization state programmatically. For more information
on using traitlets and widget events (like <code class="docutils literal notranslate"><span class="pre">observe</span></code>), please refer to
the <a class="reference external" href="https://ipywidgets.readthedocs.io/en/stable/examples/Widget%20Events.html">ipywidgets documentation</a>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="settings">
<span class="sig-name descname"><span class="pre">settings</span></span><a class="headerlink" href="#settings" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary containing the current visualization settings.
This traitlet is synchronized between Python and the JavaScript
frontend. You can update it to change visualization options
(e.g. map ranges, structure representation, camera location). See the
<a class="reference internal" href="../getting-started/json-format.html#json-settings"><span class="std std-ref">Settings (settings)</span></a> section for a list of available settings.</p>
<p>By changing the <code class="docutils literal notranslate"><span class="pre">pinned</span></code> setting, you can control the number
of viewers shown in the grid, as well as which structures are
displayed in each viewer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enable space filling representation for the active viewer</span>
<span class="n">widget</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;structure&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;spaceFilling&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}]}</span>

<span class="c1"># Set up 4 viewers with the specified structures</span>
<span class="n">widget</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;pinned&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="selected_ids">
<span class="sig-name descname"><span class="pre">selected_ids</span></span><a class="headerlink" href="#selected_ids" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary describing the currently selected structure or
environment. It contains a <code class="docutils literal notranslate"><span class="pre">structure</span></code> index and optionally
an <code class="docutils literal notranslate"><span class="pre">atom</span></code> index to indicate the active environment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select the structure with index 3 and the environment 8</span>
<span class="n">widget</span><span class="o">.</span><span class="n">selected_ids</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;structure&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;atom&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="active_viewer">
<span class="sig-name descname"><span class="pre">active_viewer</span></span><a class="headerlink" href="#active_viewer" title="Link to this definition">¶</a></dt>
<dd><p>An integer indicating the index of the currently active viewer
in the grid (0-based).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="warning_timeout">
<span class="sig-name descname"><span class="pre">warning_timeout</span></span><a class="headerlink" href="#warning_timeout" title="Link to this definition">¶</a></dt>
<dd><p>An integer controlling how warning messages are displayed (in ms). Set to a positive
value for auto dismissing warnings after the specified time, <code class="docutils literal notranslate"><span class="pre">0</span></code> for warnings that
must be manually closed or <code class="docutils literal notranslate"><span class="pre">-1</span></code> to disable warnings entirely.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Auto dismiss warnings after 5 seconds</span>
<span class="n">widget</span><span class="o">.</span><span class="n">warning_timeout</span> <span class="o">=</span> <span class="mi">5000</span>
</pre></div>
</div>
</dd></dl>

<section id="saving-the-dataset-and-settings-as-a-standalone-file">
<h3>Saving the dataset and settings as a standalone file<a class="headerlink" href="#saving-the-dataset-and-settings-as-a-standalone-file" title="Link to this heading">¶</a></h3>
<p>The “save” method allows exporting the current state of the widget
as a standalone JSON file that can be opened in the web app
(or loaded with <a class="reference internal" href="#chemiscope.show_input" title="chemiscope.show_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">chemiscope.show_input()</span></code></a>).</p>
<dl class="py method">
<dt class="sig sig-object py" id="chemiscope.jupyter.ChemiscopeWidgetBase.save">
<span class="sig-prename descclassname"><span class="pre">ChemiscopeWidgetBase.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.jupyter.ChemiscopeWidgetBase.save" title="Link to this definition">¶</a></dt>
<dd><p>Save the dataset displayed by this widget as JSON to the given <code class="docutils literal notranslate"><span class="pre">path</span></code>.
If <code class="docutils literal notranslate"><span class="pre">path</span></code> ends with <code class="docutils literal notranslate"><span class="pre">.gz</span></code>, the file is written as gzip compressed
JSON string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – where to save the dataset.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="exporting-images">
<h3>Exporting images<a class="headerlink" href="#exporting-images" title="Link to this heading">¶</a></h3>
<p>The chemiscope widget provides methods to capture snapshots of the map and
structure panels programmatically. These methods are asynchronous, as they
require communication with the browser’s JavaScript engine to render and
capture the data.</p>
<p>There are two types of methods: <code class="docutils literal notranslate"><span class="pre">save_*</span></code> methods, which write the image data
directly to a file given the path, and <code class="docutils literal notranslate"><span class="pre">get_*</span></code> methods, which return the raw
image bytes (PNG formatted).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These methods return <code class="docutils literal notranslate"><span class="pre">asyncio.Future</span></code> objects. Depending on the environment,
you may be able to <code class="docutils literal notranslate"><span class="pre">await</span></code> directly in a cell to wait for the
result. If <code class="docutils literal notranslate"><span class="pre">await</span></code> hangs in your environment, you can use
catch the <code class="docutils literal notranslate"><span class="pre">get_*</span></code> return value, and then in a separate cell get <cite>.result()</cite>
to access the actual return value.</p>
</div>
<p>Basic usage example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cell 1: Create and display the widget</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">chemiscope</span>
<span class="n">widget</span> <span class="o">=</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">structures</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
<span class="n">widget</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cell 2: Save a snapshot of the current map to a file</span>
<span class="n">widget</span><span class="o">.</span><span class="n">save_map_image</span><span class="p">(</span><span class="s2">&quot;current_map.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cell 3: Capture structure image data as raw PNG bytes</span>
<span class="n">img_future</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">get_structure_image</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display image</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">img_data</span> <span class="o">=</span> <span class="n">img_future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">img_data</span><span class="p">))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="chemiscope.jupyter.ChemiscopeWidgetBase.save_map_image">
<span class="sig-prename descclassname"><span class="pre">ChemiscopeWidgetBase.</span></span><span class="sig-name descname"><span class="pre">save_map_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.jupyter.ChemiscopeWidgetBase.save_map_image" title="Link to this definition">¶</a></dt>
<dd><p>Save a snapshot of the map to a file.</p>
<p>This method starts a background task to save the
image. You can <code class="docutils literal notranslate"><span class="pre">await</span></code> it if you need to ensure the
file is written before proceeding.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">widget</span><span class="o">.</span><span class="n">save_map_image</span><span class="p">(</span><span class="s2">&quot;map.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path where the image will be saved.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Future that resolves when the file is written.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemiscope.jupyter.ChemiscopeWidgetBase.save_structure_image">
<span class="sig-prename descclassname"><span class="pre">ChemiscopeWidgetBase.</span></span><span class="sig-name descname"><span class="pre">save_structure_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.jupyter.ChemiscopeWidgetBase.save_structure_image" title="Link to this definition">¶</a></dt>
<dd><p>Save a snapshot of the active structure viewer to a file.</p>
<p>This method starts a background task to save the image.
You can <code class="docutils literal notranslate"><span class="pre">await</span></code> it if you need to ensure the file is
written before proceeding.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">widget</span><span class="o">.</span><span class="n">save_structure_image</span><span class="p">(</span><span class="s2">&quot;structure.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path where the image will be saved.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Future that resolves when the file is written.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemiscope.jupyter.ChemiscopeWidgetBase.get_map_image">
<span class="sig-prename descclassname"><span class="pre">ChemiscopeWidgetBase.</span></span><span class="sig-name descname"><span class="pre">get_map_image</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.jupyter.ChemiscopeWidgetBase.get_map_image" title="Link to this definition">¶</a></dt>
<dd><p>Request a snapshot of the map. Returns a Future that resolves to the
image data (PNG formatted).</p>
<p>This method is asynchronous. In a Jupyter notebook, you should <code class="docutils literal notranslate"><span class="pre">await</span></code>
it to get the data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get raw image data</span>
<span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">widget</span><span class="o">.</span><span class="n">get_map_image</span><span class="p">()</span>

<span class="c1"># Display it</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>

<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A Future that resolves to the image data as bytes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemiscope.jupyter.ChemiscopeWidgetBase.get_structure_image">
<span class="sig-prename descclassname"><span class="pre">ChemiscopeWidgetBase.</span></span><span class="sig-name descname"><span class="pre">get_structure_image</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.jupyter.ChemiscopeWidgetBase.get_structure_image" title="Link to this definition">¶</a></dt>
<dd><p>Request a snapshot of the active structure viewer.
Returns a Future that resolves to the image data (PNG formatted).</p>
<p>This method is asynchronous. In a Jupyter notebook,
you should <code class="docutils literal notranslate"><span class="pre">await</span></code> it to get the data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="n">widget</span><span class="o">.</span><span class="n">get_structure_image</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A Future that resolves to the image data as bytes.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="capturing-sequences">
<h3>Capturing sequences<a class="headerlink" href="#capturing-sequences" title="Link to this heading">¶</a></h3>
<p>You can also capture a sequence of structure snapshots (e.g., for a trajectory
animation). The <code class="docutils literal notranslate"><span class="pre">indices</span></code> parameter can be a list of structure indices or
a list of dictionaries specifying both structure and atom indices.
An optional <code class="docutils literal notranslate"><span class="pre">settings</span></code> parameter allows applying specific visualization
settings to each frame.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;frame_0.png&quot;</span><span class="p">,</span> <span class="s2">&quot;frame_10.png&quot;</span><span class="p">,</span> <span class="s2">&quot;frame_20.png&quot;</span><span class="p">]</span>

<span class="c1"># Capture and save a sequence of frames</span>
<span class="n">widget</span><span class="o">.</span><span class="n">save_structure_sequence</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="chemiscope.jupyter.ChemiscopeWidgetBase.save_structure_sequence">
<span class="sig-prename descclassname"><span class="pre">ChemiscopeWidgetBase.</span></span><span class="sig-name descname"><span class="pre">save_structure_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.jupyter.ChemiscopeWidgetBase.save_structure_sequence" title="Link to this definition">¶</a></dt>
<dd><p>Save a sequence of structure snapshots to files.</p>
<p>This method acts as a wrapper around <a class="reference internal" href="#chemiscope.jupyter.ChemiscopeWidgetBase.get_structure_sequence" title="chemiscope.jupyter.ChemiscopeWidgetBase.get_structure_sequence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_structure_sequence()</span></code></a>
and writes the results to files.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;frame_0.png&quot;</span><span class="p">,</span> <span class="s2">&quot;frame_10.png&quot;</span><span class="p">,</span> <span class="s2">&quot;frame_20.png&quot;</span><span class="p">]</span>
<span class="k">await</span> <span class="n">widget</span><span class="o">.</span><span class="n">save_structure_sequence</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>list</em>) – List of indices (int or dict) to render.</p></li>
<li><p><strong>paths</strong> (<em>list</em>) – List of file paths where images will be saved.
Must match length of <code class="docutils literal notranslate"><span class="pre">indices</span></code>.</p></li>
<li><p><strong>settings</strong> (<em>list</em>) – Optional list of settings dicts to apply
to each frame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Future that resolves when all files are written.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chemiscope.jupyter.ChemiscopeWidgetBase.get_structure_sequence">
<span class="sig-prename descclassname"><span class="pre">ChemiscopeWidgetBase.</span></span><span class="sig-name descname"><span class="pre">get_structure_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.jupyter.ChemiscopeWidgetBase.get_structure_sequence" title="Link to this definition">¶</a></dt>
<dd><p>Request a sequence of structure snapshots. Returns a Future that
resolves to a list of image data (PNG formatted).</p>
<p>This allows rendering multiple frames efficiently without blocking
the UI. The sequence is processed in the browser.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">indices</span></code> list can contain integers (structure index) or
dictionaries specifying <code class="docutils literal notranslate"><span class="pre">structure</span></code> and <code class="docutils literal notranslate"><span class="pre">atom</span></code> indices
(for environments).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">settings</span></code> list, if provided, must have the same length
as <code class="docutils literal notranslate"><span class="pre">indices</span></code>. Each element is a dictionary of structure
settings (e.g. <code class="docutils literal notranslate"><span class="pre">{&quot;spaceFilling&quot;:</span> <span class="pre">True}</span></code>) to apply for
that specific frame.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">settings</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;spaceFilling&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="p">{},</span> <span class="p">{</span><span class="s2">&quot;spaceFilling&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}]</span>
<span class="n">data_list</span> <span class="o">=</span> <span class="k">await</span> <span class="n">widget</span><span class="o">.</span><span class="n">get_structure_sequence</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>list</em>) – List of indices (int or dict) to render.</p></li>
<li><p><strong>settings</strong> (<em>list</em>) – Optional list of settings dicts to apply
for each frame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Future that resolves to a list of image data bytes.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="headless-widget">
<h2>Headless widget<a class="headerlink" href="#headless-widget" title="Link to this heading">¶</a></h2>
<p>If you want to use chemiscope to generate screenshots or inspect datasets programmatically without running a Jupyter notebook, you can use the headless widget. This widget uses a headless browser (Playwright) to render the chemiscope interface, which you can fetch installing the optional dependency <code class="docutils literal notranslate"><span class="pre">chemiscope[headless]</span></code>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.headless">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">headless</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.headless" title="Link to this definition">¶</a></dt>
<dd><p>Create a headless Chemiscope instance.
Parameters match those of <cite>chemiscope.show</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width</strong> (<em>int</em>) – width of the widget container in pixels. If not specified,
it is calculated from the height (defaulting to 800 if both are missing)
to keep a 4:3 aspect ratio. Note that the output image resolution might
differ from this value (e.g. due to high-DPI scaling or internal padding).</p></li>
<li><p><strong>height</strong> (<em>int</em>) – height of the widget container in pixels. If not specified,
it is calculated from the width (defaulting to 600 if both are missing)
to keep a 4:3 aspect ratio.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>The headless widget provides the same <code class="docutils literal notranslate"><span class="pre">settings</span></code> and <code class="docutils literal notranslate"><span class="pre">selected_ids</span></code> traitlets as the main widget, and exposes the same methods for saving screenshots and sequences.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">chemiscope</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">chemiscope</span><span class="w"> </span><span class="kn">import</span> <span class="n">headless</span>

<span class="c1"># Load your data</span>
<span class="n">structures</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">properties</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># Create a headless widget instance</span>
<span class="c1"># This automatically downloads and configures the required browser</span>
<span class="n">widget</span> <span class="o">=</span> <span class="n">headless</span><span class="p">(</span><span class="n">structures</span><span class="o">=</span><span class="n">structures</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="n">properties</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;structure&quot;</span><span class="p">)</span>

<span class="c1"># Modify settings programmatically</span>
<span class="n">widget</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;structure&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;spaceFilling&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}]}</span>

<span class="c1"># Save a snapshot of the active structure</span>
<span class="n">widget</span><span class="o">.</span><span class="n">save_structure_image</span><span class="p">(</span><span class="s2">&quot;snapshot.png&quot;</span><span class="p">)</span>

<span class="c1"># Save a sequence of images</span>
<span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;frame_0.png&quot;</span><span class="p">,</span> <span class="s2">&quot;frame_1.png&quot;</span><span class="p">,</span> <span class="s2">&quot;frame_2.png&quot;</span><span class="p">]</span>
<span class="n">widget</span><span class="o">.</span><span class="n">save_structure_sequence</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">paths</span><span class="p">)</span>

<span class="c1"># Save the dataset to a JSON file</span>
<span class="n">widget</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;dataset.json&quot;</span><span class="p">)</span>

<span class="c1"># Clean up resources</span>
<span class="n">widget</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The headless widget requires the <cite>playwright</cite> python package to be installed. You can install it with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">playwright</span></code> and then run <code class="docutils literal notranslate"><span class="pre">playwright</span> <span class="pre">install</span></code> to download the browser binaries.</p>
</div>
</section>
<section id="dataset-exploration">
<h2>Dataset exploration<a class="headerlink" href="#dataset-exploration" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.explore">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">explore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featurizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.explore" title="Link to this definition">¶</a></dt>
<dd><p>Automatically generate an interactive Chemiscope visualization of atomic structures.</p>
<p>This function creates a low-dimensional representation of the input <code class="docutils literal notranslate"><span class="pre">structures</span></code>
and displays them using a Chemiscope widget. It supports automatic featurization
with <a class="reference external" href="https://arxiv.org/abs/2506.19674">PETMADFeaturizer</a> or a custom
featurization function.</p>
<p>The default <code class="docutils literal notranslate"><span class="pre">PETMADFeaturizer</span></code> computes <a class="reference external" href="https://arxiv.org/abs/2503.14118">PET-MAD</a> features from the structures and projects them
into the 3D MAD latent space.</p>
<p>If available, all properties are extracted automatically from the structures.</p>
<p>If one does not specify a <code class="docutils literal notranslate"><span class="pre">featurizer</span></code> (or sets it as a <code class="docutils literal notranslate"><span class="pre">None</span></code>), only properties
will be displayed on the map visualizer panel, as long as there are at least two of
them.</p>
<p>Overall, the visualization can include: properties extracted from the structures,
additional user-provided properties, features from either the built-in PET-MAD
featurizer, with dimensionality reduction, or a custom user-provided featurization
functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> (<em>list</em>) – list of structures</p></li>
<li><p><strong>featurizer</strong> – either string specifying a featurizer version (currently only
‘pet-mad-1.0’), a custom callable function, or None. Used to compute features
and perform dimensionality reduction on the <code class="docutils literal notranslate"><span class="pre">structures</span></code>. For automatic
default option, use <code class="docutils literal notranslate"><span class="pre">pet-mad-1.0</span></code>. The callable should take <code class="docutils literal notranslate"><span class="pre">structures</span></code> as
the first argument and <code class="docutils literal notranslate"><span class="pre">environments</span></code> as the second argument. The return value
must be a features array of shape <code class="docutils literal notranslate"><span class="pre">(n_structures,</span> <span class="pre">n_features)</span></code> if
<code class="docutils literal notranslate"><span class="pre">environments</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, or <code class="docutils literal notranslate"><span class="pre">(n_environments,</span> <span class="pre">n_features)</span></code> otherwise.</p></li>
<li><p><strong>properties</strong> (<em>dict</em>) – optional. Additional properties to be included in the
visualization. This dictionary can contain any other relevant data associated
with the atomic structures. Properties can be extracted from structures with
<a class="reference internal" href="reference.html#chemiscope.extract_properties" title="chemiscope.extract_properties"><code class="xref py py-func docutils literal notranslate"><span class="pre">extract_properties()</span></code></a> or manually defined by the user.</p></li>
<li><p><strong>environments</strong> – optional. List of environments (described as <code class="docutils literal notranslate"><span class="pre">(structure</span> <span class="pre">id,</span>
<span class="pre">center</span> <span class="pre">id,</span> <span class="pre">cutoff)</span></code>) to include when extracting the atomic properties. Can be
extracted from structures with <a class="reference internal" href="reference.html#chemiscope.all_atomic_environments" title="chemiscope.all_atomic_environments"><code class="xref py py-func docutils literal notranslate"><span class="pre">all_atomic_environments()</span></code></a> or manually
defined.</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – optional dictionary of settings to use when displaying the
data. Possible entries for the <code class="docutils literal notranslate"><span class="pre">settings</span></code> dictionary are documented in the
chemiscope input file reference.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – optional. Visualization mode for the chemiscope widget. Can be one
of “default”, “structure”, or “map”. The default mode is “default”.</p></li>
<li><p><strong>write_input</strong> (<em>string</em>) – optional. A path to save the chemiscope input file
created by this function. Afterwards, the file can be loaded using
<a class="reference internal" href="#chemiscope.show_input" title="chemiscope.show_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">chemiscope.show_input()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a chemiscope widget for interactive visualization</p>
</dd>
</dl>
<p>To use this function, additional dependencies are required, specifically, <a class="reference external" href="https://arxiv.org/abs/2503.14118">pet-mad</a>
used for the default dimensionality reduction. They can be installed with the
following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>chemiscope<span class="o">[</span>explore<span class="o">]</span>
</pre></div>
</div>
<p>Here is an example using this function with and without a featurizer function. The
structures are obtained by reading the structures from a file that <a class="reference external" href="https://ase-lib.org/ase/ase/io/io.html">ase</a>
can read, and performing Kernel PCA using <a class="reference external" href="https://scikit-learn.org/">sklearn</a> on a descriptor computed with
SOAP using the <a class="reference external" href="https://singroup.github.io/dscribe/latest/">dscribe</a> library.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">chemiscope</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ase.io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dscribe.descriptors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sklearn.decomposition</span>

<span class="c1"># Read the structures from the dataset</span>
<span class="n">structures</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;trajectory.xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="c1"># 1) Basic usage with default featurizer (PET-MAD featurization + Sketch-Map)</span>
<span class="n">chemiscope</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">structures</span><span class="p">,</span> <span class="n">featurizer</span><span class="o">=</span><span class="s2">&quot;pet-mad-1.0&quot;</span><span class="p">)</span>

<span class="c1"># or</span>
<span class="n">featurizer</span> <span class="o">=</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="s2">&quot;pet-mad-1.0&quot;</span><span class="p">)</span>
<span class="n">chemiscope</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">structures</span><span class="p">,</span> <span class="n">featurizer</span><span class="o">=</span><span class="n">featurizer</span><span class="p">)</span>


<span class="c1"># Define a function for dimensionality reduction</span>
<span class="k">def</span><span class="w"> </span><span class="nf">soap_kpca_featurize</span><span class="p">(</span><span class="n">structures</span><span class="p">,</span> <span class="n">environments</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">environments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;environments&#39; are not supported by this featurizer&quot;</span><span class="p">)</span>
    <span class="c1"># Compute descriptors</span>
    <span class="n">soap</span> <span class="o">=</span> <span class="n">dscribe</span><span class="o">.</span><span class="n">descriptors</span><span class="o">.</span><span class="n">SOAP</span><span class="p">(</span>
        <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">],</span>
        <span class="n">r_cut</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span>
        <span class="n">n_max</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="n">l_max</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
        <span class="n">periodic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">descriptors</span> <span class="o">=</span> <span class="n">soap</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">structures</span><span class="p">)</span>

    <span class="c1"># Apply KPCA</span>
    <span class="n">kpca</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">decomposition</span><span class="o">.</span><span class="n">KernelPCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

    <span class="c1"># Return a 2D array of reduced features</span>
    <span class="k">return</span> <span class="n">kpca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">descriptors</span><span class="p">)</span>


<span class="c1"># 2) Example with a custom featurizer function</span>
<span class="n">chemiscope</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">structures</span><span class="p">,</span> <span class="n">featurizer</span><span class="o">=</span><span class="n">soap_kpca_featurize</span><span class="p">)</span>
</pre></div>
</div>
<p>For more examples, see the related <a class="reference external" href="https://chemiscope.org/docs/examples/6-explore.html">documentation</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.get_featurizer">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">get_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.get_featurizer" title="Link to this definition">¶</a></dt>
<dd><p>Get a featurizer by name for feature extraction. Currently available version is:
“pet-mad-1.0”, which returns an instance of <a class="reference external" href="https://arxiv.org/abs/2506.19674">PETMADFeaturizer</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – name of the featurizer. Must match one of the known versions.
Currently available is “pet-mad-1.0”</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function requires additional dependencies. Install them using:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>chemiscope<span class="o">[</span>explore<span class="o">]</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.metatomic_featurizer">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">metatomic_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">extensions_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_consistency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Angstrom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.metatomic_featurizer" title="Link to this definition">¶</a></dt>
<dd><p>Create a featurizer function using a <a class="reference external" href="https://docs.metatensor.org/metatomic/">metatomic</a> model to obtain the features from
structures. The model must be able to create a <code class="docutils literal notranslate"><span class="pre">&quot;features&quot;</span></code> output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model to use for the calculation. It can be a file path, a Python
instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">metatomic.torch.AtomisticModel</span></code>, or the output of
<code class="xref py py-func docutils literal notranslate"><span class="pre">torch.jit.script()</span></code> on <code class="xref py py-class docutils literal notranslate"><span class="pre">metatomic.torch.AtomisticModel</span></code>.</p></li>
<li><p><strong>extensions_directory</strong> – a directory where model extensions are located</p></li>
<li><p><strong>check_consistency</strong> – should we check the model for consistency when running,
defaults to False.</p></li>
<li><p><strong>device</strong> – a torch device to use for the calculation. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the function
will use the options in model’s <code class="docutils literal notranslate"><span class="pre">supported_device</span></code> attribute.</p></li>
<li><p><strong>length_unit</strong> – Unit of length used in the structures.</p></li>
<li><p><strong>variant</strong> – selects which feature output variant to use. By default, the main
<code class="docutils literal notranslate"><span class="pre">&quot;features&quot;</span></code> output is used. To choose another variant, provide its name
(e.g., <code class="docutils literal notranslate"><span class="pre">&quot;cos_sin&quot;</span></code>), which will select the corresponding
<code class="docutils literal notranslate"><span class="pre">&quot;features/&lt;variant&gt;&quot;</span></code> output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a function that takes a list of structures and returns the features.</p>
</dd>
</dl>
<p>To use this function, additional dependencies are required. They can be installed
with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>chemiscope<span class="o">[</span>explore<span class="o">]</span>
</pre></div>
</div>
<p>Here is an example using a pre-trained <a class="reference external" href="https://docs.metatensor.org/metatomic/">metatomic</a> model, stored as a <code class="docutils literal notranslate"><span class="pre">model.pt</span></code>
file with the compiled extensions stored in the <code class="docutils literal notranslate"><span class="pre">extensions/</span></code> directory. The
structures are obtained by reading structures from a file that <a class="reference external" href="https://ase-lib.org/ase/ase/io/io.html">ase</a> can
read.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">chemiscope</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ase.io</span>

<span class="c1"># Read the structures from the dataset</span>
<span class="n">structures</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;data/explore_c-gap-20u.xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="c1"># Provide model file (&quot;model.pt&quot;) to `metatomic_featurizer`</span>
<span class="n">featurizer</span> <span class="o">=</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">metatomic_featurizer</span><span class="p">(</span>
    <span class="s2">&quot;model.pt&quot;</span><span class="p">,</span> <span class="n">extensions_directory</span><span class="o">=</span><span class="s2">&quot;extensions&quot;</span>
<span class="p">)</span>

<span class="n">chemiscope</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">structures</span><span class="p">,</span> <span class="n">featurizer</span><span class="o">=</span><span class="n">featurizer</span><span class="p">)</span>
</pre></div>
</div>
<p>For more examples, see the related <a class="reference internal" href="../examples/8-explore-with-metatomic.html#chemiscope-explore-metatomic"><span class="std std-ref">documentation</span></a>.</p>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="streamlit.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Chemiscope in <code class="docutils literal notranslate"><span class="pre">streamlit</span></code></div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="reference.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><code class="docutils literal notranslate"><span class="pre">chemiscope</span></code> functions reference</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020-2026, chemiscope developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Jupyter notebooks</a><ul>
<li><a class="reference internal" href="#creating-a-chemiscope-widget">Creating a chemiscope widget</a><ul>
<li><a class="reference internal" href="#chemiscope.show"><code class="docutils literal notranslate"><span class="pre">show()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.show_input"><code class="docutils literal notranslate"><span class="pre">show_input()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#widget-properties-and-methods">Widget properties and methods</a><ul>
<li><a class="reference internal" href="#settings"><code class="docutils literal notranslate"><span class="pre">settings</span></code></a></li>
<li><a class="reference internal" href="#selected_ids"><code class="docutils literal notranslate"><span class="pre">selected_ids</span></code></a></li>
<li><a class="reference internal" href="#active_viewer"><code class="docutils literal notranslate"><span class="pre">active_viewer</span></code></a></li>
<li><a class="reference internal" href="#warning_timeout"><code class="docutils literal notranslate"><span class="pre">warning_timeout</span></code></a></li>
<li><a class="reference internal" href="#saving-the-dataset-and-settings-as-a-standalone-file">Saving the dataset and settings as a standalone file</a><ul>
<li><a class="reference internal" href="#chemiscope.jupyter.ChemiscopeWidgetBase.save"><code class="docutils literal notranslate"><span class="pre">ChemiscopeWidgetBase.save()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#exporting-images">Exporting images</a><ul>
<li><a class="reference internal" href="#chemiscope.jupyter.ChemiscopeWidgetBase.save_map_image"><code class="docutils literal notranslate"><span class="pre">ChemiscopeWidgetBase.save_map_image()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.jupyter.ChemiscopeWidgetBase.save_structure_image"><code class="docutils literal notranslate"><span class="pre">ChemiscopeWidgetBase.save_structure_image()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.jupyter.ChemiscopeWidgetBase.get_map_image"><code class="docutils literal notranslate"><span class="pre">ChemiscopeWidgetBase.get_map_image()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.jupyter.ChemiscopeWidgetBase.get_structure_image"><code class="docutils literal notranslate"><span class="pre">ChemiscopeWidgetBase.get_structure_image()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#capturing-sequences">Capturing sequences</a><ul>
<li><a class="reference internal" href="#chemiscope.jupyter.ChemiscopeWidgetBase.save_structure_sequence"><code class="docutils literal notranslate"><span class="pre">ChemiscopeWidgetBase.save_structure_sequence()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.jupyter.ChemiscopeWidgetBase.get_structure_sequence"><code class="docutils literal notranslate"><span class="pre">ChemiscopeWidgetBase.get_structure_sequence()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#headless-widget">Headless widget</a><ul>
<li><a class="reference internal" href="#chemiscope.headless"><code class="docutils literal notranslate"><span class="pre">headless()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#dataset-exploration">Dataset exploration</a><ul>
<li><a class="reference internal" href="#chemiscope.explore"><code class="docutils literal notranslate"><span class="pre">explore()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.get_featurizer"><code class="docutils literal notranslate"><span class="pre">get_featurizer()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.metatomic_featurizer"><code class="docutils literal notranslate"><span class="pre">metatomic_featurizer()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>