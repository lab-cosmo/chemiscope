<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Jupyter notebooks" href="jupyter.html"><link rel="prev" title="Command line interface" href="cli.html">
        <link rel="prefetch" href="../_static/chemiscope-icon-no-name.svg" as="image">

    <link rel="shortcut icon" href="../_static/chemiscope-icon.png"><!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>chemiscope functions reference - chemiscope 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/chemiscope.css?v=842a4e29" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-background-secondary: #f4f8ff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-background-secondary: #303d4f;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-background-secondary: #303d4f;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">chemiscope 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/chemiscope-icon-no-name.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">chemiscope 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Chemiscope</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting-started/index.html">Getting started</a><input aria-label="Toggle navigation of Getting started" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/properties.html">Introduction to structural properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/panels.html">Different panels and settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/input.html">Creating inputs with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/json-format.html">Chemiscope JSON file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/sharing.html">Sharing datasets with collaborators</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Examples</a><input aria-label="Toggle navigation of Examples" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/1-base.html">Simple chemiscope input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/2-structure_map.html">Structure-property maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/3-trajectory.html">Trajectory plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/4-colors.html">Atom property coloring and labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/5-shapes.html">Shape visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/6-explore.html">Exploring dataset with chemiscope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/7-explore-advanced.html">Advanced dataset exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/8-explore-with-metatomic.html">Using metatomic models for dataset exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/9-stk-custom-bonds.html">Using stk structures and showing custom bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/10-visualizing-biomolecules.html">Visualize biomolecules with MDAnalysis or chemfiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/11-headless.html">Headless mode</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Python module</a><input aria-label="Toggle navigation of Python module" checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cli.html">Command line interface</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">chemiscope</span></code> functions reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="jupyter.html">Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="streamlit.html">Chemiscope in <code class="docutils literal notranslate"><span class="pre">streamlit</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="sphinx.html">Chemiscope in <code class="docutils literal notranslate"><span class="pre">sphinx</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="gallery.html">Use with <code class="docutils literal notranslate"><span class="pre">sphinx-gallery</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../embedding.html">Chemiscope as a library</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/python/reference.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="chemiscope-functions-reference">
<span id="reference"></span><h1><code class="docutils literal notranslate"><span class="pre">chemiscope</span></code> functions reference<a class="headerlink" href="#chemiscope-functions-reference" title="Link to this heading">¶</a></h1>
<section id="input-files">
<h2>Input files<a class="headerlink" href="#input-files" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.create_input">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">create_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.create_input" title="Link to this definition">¶</a></dt>
<dd><p>Create a dictionary that can be saved to JSON using the format used by the default
chemiscope visualizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> (<em>list</em>) – list of atomic structures. These can be either <cite>chemiscope</cite>
compatible dictionaries, or <a class="reference external" href="https://ase-lib.org/ase/ase/atoms.html">ase.Atoms</a>, <a class="reference external" href="https://stk.readthedocs.io/en/stable/_autosummary/stk.BuildingBlock.html#stk.BuildingBlock">stk.BuildingBlocks</a>, and
<a class="reference external" href="https://docs.mdanalysis.org/2.9.0/documentation_pages/core/groups.html#MDAnalysis.core.groups.AtomGroup">MDAnalysis.AtomGroup</a> objects.</p></li>
<li><p><strong>metadata</strong> (<em>dict</em>) – optional metadata of the dataset, see below</p></li>
<li><p><strong>properties</strong> (<em>dict</em>) – optional dictionary of properties, see below</p></li>
<li><p><strong>environments</strong> (<em>list</em>) – optional list of <code class="docutils literal notranslate"><span class="pre">(structure</span> <span class="pre">id,</span> <span class="pre">atom</span> <span class="pre">id,</span> <span class="pre">cutoff)</span></code>
specifying which atoms have properties attached and how far out atom-centered
environments should be drawn by default. Functions like
<a class="reference internal" href="#chemiscope.all_atomic_environments" title="chemiscope.all_atomic_environments"><code class="xref py py-func docutils literal notranslate"><span class="pre">all_atomic_environments()</span></code></a> can be used to generate the list of
environments in simple cases.</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – optional dictionary of settings to use when displaying the
data. Possible entries for the <code class="docutils literal notranslate"><span class="pre">settings</span></code> dictionary are documented in the
<a class="reference internal" href="../getting-started/json-format.html#json-settings"><span class="std std-ref">Settings (settings)</span></a> section.</p></li>
<li><p><strong>parameters</strong> (<em>dict</em>) – optional dictionary of parameters for multidimensional
properties, see below</p></li>
</ul>
</dd>
</dl>
<p>For complete format specifications, parameter types, and more examples, see <cite>JSON
file format &lt;json-format&gt;</cite>.</p>
<section id="dataset-metadata">
<h3>Dataset metadata<a class="headerlink" href="#dataset-metadata" title="Link to this heading">¶</a></h3>
<p>The dataset metadata should be given in the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dictionary, the possible
keys are:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># str, dataset name</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="c1"># str, dataset description</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="c1"># list of str, dataset authors, OPTIONAL</span>
    <span class="s2">&quot;authors&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c1"># list of str, references for this dataset, OPTIONAL</span>
    <span class="s2">&quot;references&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="dataset-properties">
<h3>Dataset properties<a class="headerlink" href="#dataset-properties" title="Link to this heading">¶</a></h3>
<p>Properties can be added with the <code class="docutils literal notranslate"><span class="pre">properties</span></code> parameter. This parameter should be
a dictionary containing one entry for each property. Properties can be extracted
from structures with <a class="reference internal" href="#chemiscope.extract_properties" title="chemiscope.extract_properties"><code class="xref py py-func docutils literal notranslate"><span class="pre">extract_properties()</span></code></a>, or manually defined by the user.</p>
<p>Each entry in the <code class="docutils literal notranslate"><span class="pre">properties</span></code> dictionary contains a <code class="docutils literal notranslate"><span class="pre">target</span></code> attribute
(<code class="docutils literal notranslate"><span class="pre">'atom'</span></code> or <code class="docutils literal notranslate"><span class="pre">'structure'</span></code>) and a set of values. <code class="docutils literal notranslate"><span class="pre">values</span></code> can be a Python list
of float or string; a 1D numpy array of numeric values; or a 2D numpy array of
numeric values. In the later case, multiple properties will be generated along the
second axis. For example, passing</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cheese&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;atom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">300</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
        <span class="c1"># optional: property unit</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;random / fs&quot;</span><span class="p">,</span>
        <span class="c1"># optional: property description</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a random property for example&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>will generate four properties named <code class="docutils literal notranslate"><span class="pre">cheese[1]</span></code>, <code class="docutils literal notranslate"><span class="pre">cheese[2]</span></code>, <code class="docutils literal notranslate"><span class="pre">cheese[3]</span></code>, and
<code class="docutils literal notranslate"><span class="pre">cheese[4]</span></code>, each containing 300 values.</p>
<p>It is also possible to pass shortened representation of the properties, for
instance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cheese&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">300</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this case, the type of property (structure or atom) would be deduced by comparing
the numbers atoms and structures in the dataset to the length of provided
list/np.ndarray.</p>
</section>
<section id="multi-dimensional-properties">
<h3>Multi-dimensional properties<a class="headerlink" href="#multi-dimensional-properties" title="Link to this heading">¶</a></h3>
<p>One can give 2D properties to be displayed as curves in the info panel by setting a
<code class="docutils literal notranslate"><span class="pre">parameters</span></code> in the property, and giving the corresponding <code class="docutils literal notranslate"><span class="pre">parameters</span></code> values
to this function. The previous example becomes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cheese&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;atom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">300</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
        <span class="c1"># optional: property unit</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;random / fs&quot;</span><span class="p">,</span>
        <span class="c1"># optional: property description</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;a random property for examples&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This input describes a 2D property <code class="docutils literal notranslate"><span class="pre">cheese</span></code> with 300 samples and 4 values taken by
the <code class="docutils literal notranslate"><span class="pre">origin</span></code> parameter. We also need to provide the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> values to this
function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;origin&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># an array of numbers containing the values of the parameter</span>
        <span class="c1"># the size should correspond to the second dimension</span>
        <span class="c1"># of the corresponding multidimensional property</span>
        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="c1"># optional free-form description of the parameter as a string</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;a short description of this parameter&quot;</span><span class="p">,</span>
        <span class="c1"># optional units of the values in the values array</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;eV&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="custom-shapes">
<h3>Custom shapes<a class="headerlink" href="#custom-shapes" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">shapes</span></code> option should have the format <code class="docutils literal notranslate"><span class="pre">{&quot;&lt;name&gt;&quot;:</span> <span class="pre">shape_definition</span> <span class="pre">}</span></code>,
where each shape is defined as a dictionary containing the kind of shape, and its
parameters</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">shapes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;shape name&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="s2">&quot;sphere&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="n">shape_parameters</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each parameters block defines <cite>global</cite>, <cite>structure</cite> and <cite>atom</cite> - level parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;global&quot;</span><span class="p">:</span> <span class="n">global_parameters</span><span class="p">,</span>
    <span class="s2">&quot;structure&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">structure_1</span><span class="p">,</span> <span class="n">structure_2</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="s2">&quot;atom&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">atom_1</span><span class="p">,</span> <span class="n">atom_2</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each of these can contain some or all of the parameters associated with each shape,
and the parameters for each shape are obtained by combining the parameters from the
most general to the most specific, i.e., if there is a duplicate key in the
<code class="docutils literal notranslate"><span class="pre">global</span></code> and <code class="docutils literal notranslate"><span class="pre">atom</span></code> fields, the value within the <code class="docutils literal notranslate"><span class="pre">atom</span></code> field will supersede
the <code class="docutils literal notranslate"><span class="pre">global</span></code> field for that atom. The parameters for atom <code class="docutils literal notranslate"><span class="pre">k</span></code> that is part of
structure <code class="docutils literal notranslate"><span class="pre">j</span></code> are obtained as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">global_parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">structure_j</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">atom_k</span><span class="p">)</span>
</pre></div>
</div>
<p>If given, the <cite>structure</cite> parameters list should contain one entry per structure,
and the <cite>atom</cite> parameters list should be a flat list corresponding to the atoms of
each consecutive structure. All shapes accept a few general parameters, and some
specific ones</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># general parameters</span>
<span class="p">{</span>
    <span class="c1"># centering (defaults to origin for structure, atom position for atom)</span>
    <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="c1"># scaling of the size of the shape</span>
    <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="c1"># optional, given as quaternion in (x, y, z, w) format</span>
    <span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">string</span> <span class="o">|</span> <span class="n">hex_code</span><span class="p">,</span>  <span class="c1"># e.g. 0xFF0000</span>
<span class="p">}</span>

<span class="c1"># &quot;kind&quot; : &quot;sphere&quot;</span>
<span class="p">{</span>
    <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># &quot;kind&quot; : &quot;ellipsoid&quot;</span>
<span class="p">{</span>
    <span class="s2">&quot;semiaxes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># &quot;kind&quot; : &quot;cylinder&quot;</span>
<span class="p">{</span>
    <span class="c1"># &quot;orientation&quot; is redundant and hence ignored</span>
    <span class="s2">&quot;vector&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>  <span class="c1"># orientation and shape of the cylinder</span>
    <span class="c1"># the tip of the cylinder is at the end of the segment.</span>
    <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># &quot;kind&quot; : &quot;arrow&quot;</span>
<span class="p">{</span>
    <span class="c1"># &quot;orientation&quot; is redundant and hence ignored</span>
    <span class="s2">&quot;vector&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>  <span class="c1"># orientation and shape of the arrow</span>
    <span class="s2">&quot;baseRadius&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="s2">&quot;headRadius&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="c1"># the tip of the arrow is at the end of the segment.</span>
    <span class="c1"># It will extend past the base point if the arrow is not long enough</span>
    <span class="s2">&quot;headLength&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># &quot;kind&quot; : &quot;custom&quot;</span>
<span class="p">{</span>
    <span class="s2">&quot;vertices&quot;</span><span class="p">:</span> <span class="p">[</span>  <span class="c1"># list of vertices</span>
        <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c1"># mesh triangulation (optional); computed via convex triangulation</span>
    <span class="c1"># where omitted</span>
    <span class="s2">&quot;simplices&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>  <span class="c1"># indices refer to the list of vertices</span>
        <span class="o">...</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.write_input">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">write_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.write_input" title="Link to this definition">¶</a></dt>
<dd><p>Create the input JSON file used by the default chemiscope visualizer, and save it to
the given <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em><em> | </em><em>Path</em><em> | </em><em>file-like</em>) – name of the file to use to save the json data.
If it ends with ‘.gz’, a gzip compressed file will be written</p></li>
<li><p><strong>structures</strong> (<em>list</em>) – list of atomic structures.</p></li>
<li><p><strong>metadata</strong> (<em>dict</em>) – optional metadata of the dataset</p></li>
<li><p><strong>properties</strong> (<em>dict</em>) – optional dictionary of additional properties</p></li>
<li><p><strong>environments</strong> (<em>list</em>) – optional list of <code class="docutils literal notranslate"><span class="pre">(structure</span> <span class="pre">id,</span> <span class="pre">atom</span> <span class="pre">id,</span> <span class="pre">cutoff)</span></code>
specifying which atoms have properties attached and how far out atom-centered
environments should be drawn by default.</p></li>
<li><p><strong>shapes</strong> (<em>dict</em>) – optional dictionary of shapes to have available for display. See
<a class="reference internal" href="#chemiscope.create_input" title="chemiscope.create_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_input()</span></code></a> for more information on how to define shapes.</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – optional dictionary of settings to use when displaying the
data. Possible entries for the <code class="docutils literal notranslate"><span class="pre">settings</span></code> dictionary are documented in the
chemiscope input file reference.</p></li>
<li><p><strong>parameters</strong> (<em>dict</em>) – optional dictionary of parameters of multidimensional
properties</p></li>
</ul>
</dd>
</dl>
<p>This function uses <a class="reference internal" href="#chemiscope.create_input" title="chemiscope.create_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_input()</span></code></a> to generate the input data, see the
documentation of this function for more information.</p>
<p>Here is a quick example of generating a chemiscope input reading the structures from
a file that <a class="reference external" href="https://ase-lib.org/ase/ase/io/io.html">ase</a> can read, and performing PCA using <a class="reference external" href="https://scikit-learn.org/">sklearn</a> on a
descriptor computed with another package.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">ase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ase</span><span class="w"> </span><span class="kn">import</span> <span class="n">io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sklearn</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">decomposition</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">chemiscope</span>

<span class="n">structures</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;trajectory.xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="c1"># example property 1: list containing the energy of each structure,</span>
<span class="c1"># from calculations performed beforehand</span>
<span class="n">energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;energies.txt&quot;</span><span class="p">)</span>

<span class="c1"># example property 2: PCA projection computed using sklearn.</span>
<span class="c1"># X contains a multi-dimensional descriptor of the structure</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">decomposition</span><span class="o">.</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># if the ASE structures also contain additional data, they can be easily</span>
<span class="c1"># extracted as a dictionary using a simple utility function</span>
<span class="n">structures_properties</span> <span class="o">=</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">extract_properties</span><span class="p">(</span>
    <span class="n">structures</span><span class="p">,</span>
    <span class="n">only</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;classification&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># alternatively, properties can also be defined manually</span>
<span class="n">properties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;PCA&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;atom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">pca</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;PCA of per-atom representation of the structures&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;energies&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">energies</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;kcal/mol&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="c1"># additional multidimensional properties to be plotted</span>
<span class="n">dos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># load the 2D data</span>
<span class="n">dos_energy_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">multidimensional_properties</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;DOS&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;structure&quot;</span><span class="p">,</span>
        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">dos</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;energy&quot;</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">multidimensional_parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;energy&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="n">dos_energy_grid</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;eV&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># merge all properties together</span>
<span class="n">properties</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">structures_properties</span><span class="p">)</span>
<span class="n">properties</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">multidimensional_properties</span><span class="p">)</span>

<span class="n">chemiscope</span><span class="o">.</span><span class="n">write_input</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;chemiscope.json.gz&quot;</span><span class="p">,</span>
    <span class="n">structures</span><span class="o">=</span><span class="n">structures</span><span class="p">,</span>
    <span class="n">properties</span><span class="o">=</span><span class="n">properties</span><span class="p">,</span>
    <span class="c1"># This is required to display properties with `target: &quot;atom&quot;`</span>
    <span class="n">environments</span><span class="o">=</span><span class="n">chemiscope</span><span class="o">.</span><span class="n">all_atomic_environments</span><span class="p">(</span><span class="n">structures</span><span class="p">),</span>
    <span class="c1"># this is necessary to plot the multidimensional data</span>
    <span class="n">parameters</span><span class="o">=</span><span class="n">multidimensional_parameters</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.quick_settings">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">quick_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'structure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.quick_settings" title="Link to this definition">¶</a></dt>
<dd><p>A utility function to return a <code class="docutils literal notranslate"><span class="pre">settings</span></code> dictionary with the most basic
options for a chemiscope viewer (e.g. what to show on the axes).</p>
<p><code class="docutils literal notranslate"><span class="pre">map_settings</span></code> and <code class="docutils literal notranslate"><span class="pre">structure_settings</span></code> will override the values if specified,
e.g. <code class="docutils literal notranslate"><span class="pre">quick_settings(x=&quot;PCA[1]&quot;,</span> <span class="pre">map_settings={&quot;x&quot;:</span> <span class="pre">&quot;energy&quot;})</span></code> will set “energy”
as x-axis.</p>
<p>All the parameters are optional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>str</em>) – The property to show on the x axis of the map</p></li>
<li><p><strong>y</strong> (<em>str</em>) – The property to show on the y axis of the map.</p></li>
<li><p><strong>z</strong> (<em>str</em>) – The property to show on the z axis of the map.</p></li>
<li><p><strong>map_color</strong> (<em>str</em>) – The property to use to color the map.</p></li>
<li><p><strong>structure_color</strong> (<em>str</em>) – The property to use to color the structure.</p></li>
<li><p><strong>size</strong> (<em>str</em>) – The property to use to determine data point size.</p></li>
<li><p><strong>symbol</strong> (<em>str</em>) – The (categorical) property to use to determine point markers.</p></li>
<li><p><strong>trajectory</strong> (<em>bool</em>) – A boolean flag that sets some default options suitable to
view trajectory data: fixing the viewpoint for the structure, reducing the delay
when cycling between structures and adding a line joining the points in the map.</p></li>
<li><p><strong>periodic</strong> (<em>bool</em>) – A boolean flag that sets some default options suitable to
view periodic structures: showing the unit cell, and replicating the structure
to show atoms at the boundaries of the unit cell.</p></li>
<li><p><strong>target</strong> (<em>str</em>) – An option between “atom” and “structure” that determines whether
the properties shown should be those of environments or of structures.</p></li>
<li><p><strong>map_settings</strong> (<em>dict</em>) – Additional settings for the map (following the chemiscope
settings schema). It will override the settings specified from other map
parameters, e.g., <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code> -axes, <code class="docutils literal notranslate"><span class="pre">map_color</span></code> etc.</p></li>
<li><p><strong>structure_settings</strong> (<em>dict</em>) – Additional settings for the structure viewer
(following the chemiscope settings schema). It will override the settings
specified from other parameters, e.g., <code class="docutils literal notranslate"><span class="pre">structure_color</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="data-management">
<h2>Data management<a class="headerlink" href="#data-management" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.extract_properties">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">extract_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">environments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.extract_properties" title="Link to this definition">¶</a></dt>
<dd><p>Extract properties defined in the <code class="docutils literal notranslate"><span class="pre">structures</span></code> in a chemiscope-compatible format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> – iterable over structures</p></li>
<li><p><strong>only</strong> – optional, list of strings. If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, only properties with a name
from this list are included in the output.</p></li>
<li><p><strong>environments</strong> – optional, list of environments (described as <code class="docutils literal notranslate"><span class="pre">(structure</span> <span class="pre">id,</span>
<span class="pre">center</span> <span class="pre">id,</span> <span class="pre">cutoff)</span></code>) to include when extracting the atomic properties.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.all_atomic_environments">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">all_atomic_environments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.all_atomic_environments" title="Link to this definition">¶</a></dt>
<dd><p>Generate a list of environments containing all the atoms in the given
<code class="docutils literal notranslate"><span class="pre">structures</span></code>. The optional spherical <code class="docutils literal notranslate"><span class="pre">cutoff</span></code> radius is used to display the
environments in chemiscope.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> – iterable over structures</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>) – spherical cutoff radius used when displaying the
environments</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.ellipsoid_from_tensor">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">ellipsoid_from_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_positive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.ellipsoid_from_tensor" title="Link to this definition">¶</a></dt>
<dd><p>Returns an ellipsoid (semiaxes + quaternion) representation of a positive definite
tensor (e.g. a polarizability), in the form required by the chemiscope input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> – a positive-definite tensor (3x3 or a 6-array [xx,yy,zz,xy,xz,yz])</p></li>
<li><p><strong>scale</strong> – conversion from the units of the tensor to the units of the atomic
positions (usually Å)</p></li>
<li><p><strong>force_positive</strong> – takes the absolute value of eigenvalues, to handle
non-positive tensors</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.arrow_from_vector">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">arrow_from_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_radius_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_length_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.arrow_from_vector" title="Link to this definition">¶</a></dt>
<dd><p>Draws an arrow from the origin to the specified 3D <code class="docutils literal notranslate"><span class="pre">position</span></code>. Returns a custom
shape in the form required by the chemiscope input. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> for the arrow shape
parameters to leave them undefined (so that they can be specified in the global
parameters).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> – 3D vector (list or array of 3 floats) specifying the arrow endpoint</p></li>
<li><p><strong>scale</strong> – conversion from the units of the vector to the units of the atomic
positions (usually Å)</p></li>
<li><p><strong>radius</strong> – radius of the stem of the arrow (same units as the atomic positions,
typically Å)</p></li>
<li><p><strong>head_radius_scale</strong> – radius of the arrow tip, relative to the stem radius</p></li>
<li><p><strong>head_length_scale</strong> – length of the arrow tip, relative to the stem radius</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.ase_vectors_to_arrows">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">ase_vectors_to_arrows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_radius_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head_length_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.ase_vectors_to_arrows" title="Link to this definition">¶</a></dt>
<dd><p>Extract a vectorial atom property from a list of <code class="docutils literal notranslate"><span class="pre">ase.Atoms</span></code>, and returns
a list of arrow shapes. Besides the specific parameters it also accepts the same
parameters as <a class="reference internal" href="#chemiscope.arrow_from_vector" title="chemiscope.arrow_from_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">arrow_from_vector()</span></code></a>, which are used to define the style of
the arrows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> – list of ASE Atoms</p></li>
<li><p><strong>key</strong> – name of the ASE atom property. Should contain three components
corresponding to x,y,z</p></li>
<li><p><strong>target</strong> – whether the properties should be associated with the entire
structure, or each atom (<code class="docutils literal notranslate"><span class="pre">structure</span></code> or <code class="docutils literal notranslate"><span class="pre">atom</span></code>). defaults to autodetection</p></li>
<li><p><strong>scale</strong> – conversion from the units of the vector to the units of the atomic
positions (usually Å)</p></li>
<li><p><strong>radius</strong> – radius of the stem of the arrow (same units as the atomic positions,
typically Å)</p></li>
<li><p><strong>head_radius_scale</strong> – radius of the arrow tip, relative to the stem radius</p></li>
<li><p><strong>head_length_scale</strong> – length of the arrow tip, relative to the stem radius</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.ase_tensors_to_ellipsoids">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">ase_tensors_to_ellipsoids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_positive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.ase_tensors_to_ellipsoids" title="Link to this definition">¶</a></dt>
<dd><p>Extract a 2-tensor atom property from a list of <code class="docutils literal notranslate"><span class="pre">ase.Atoms</span></code>, and returns a list of
ellipsoids shapes. Besides the specific parameters it also accepts the same
parameters as <a class="reference internal" href="#chemiscope.ellipsoid_from_tensor" title="chemiscope.ellipsoid_from_tensor"><code class="xref py py-func docutils literal notranslate"><span class="pre">ellipsoid_from_tensor()</span></code></a>, which are used to draw the shapes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> – list of ASE Atoms</p></li>
<li><p><strong>key</strong> – name of the ASE atom property. Should contain nine components
corresponding to xx,xy,xz,yx,yy,yz,zx,zy,zz or six components corresponding to
xx,yy,zz,xy,xz,yz</p></li>
<li><p><strong>target</strong> – whether the properties should be associated with the entire
structure, or each atom (<code class="docutils literal notranslate"><span class="pre">structure</span></code> or <code class="docutils literal notranslate"><span class="pre">atom</span></code>). defaults to autodetection</p></li>
<li><p><strong>scale</strong> – see <a class="reference internal" href="#chemiscope.ellipsoid_from_tensor" title="chemiscope.ellipsoid_from_tensor"><code class="xref py py-func docutils literal notranslate"><span class="pre">ellipsoid_from_tensor()</span></code></a></p></li>
<li><p><strong>force_positive</strong> – see <a class="reference internal" href="#chemiscope.ellipsoid_from_tensor" title="chemiscope.ellipsoid_from_tensor"><code class="xref py py-func docutils literal notranslate"><span class="pre">ellipsoid_from_tensor()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="chemiscope.write_external_structures">
<span class="sig-prename descclassname"><span class="pre">chemiscope.</span></span><span class="sig-name descname"><span class="pre">write_external_structures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'structure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compresslevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chemiscope.write_external_structures" title="Link to this definition">¶</a></dt>
<dd><p>Export a list of structures to external JSON files, and returns a list of
dictionaries that can be used to create a chemiscope dataset that references them.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">structures</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;trajectory.xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="n">user_structures</span> <span class="o">=</span> <span class="n">chemiscope</span><span class="o">.</span><span class="n">write_external_structures</span><span class="p">(</span>
    <span class="n">structures</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;my_structure&quot;</span>
<span class="p">)</span>

<span class="n">write_input</span><span class="p">(</span><span class="s2">&quot;chemiscope.json&quot;</span><span class="p">,</span> <span class="n">structures</span><span class="o">=</span><span class="n">user_structures</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> (<em>list</em>) – list of atomic structures in a format that can be understood
by <code class="docutils literal notranslate"><span class="pre">chemiscope</span></code>.</p></li>
<li><p><strong>prefix</strong> (<em>str</em>) – prefix to use for each generated JSON filename. Files will be
named like <code class="docutils literal notranslate"><span class="pre">{prefix}-0.json</span></code>, <code class="docutils literal notranslate"><span class="pre">{prefix}-1.json</span></code> etc.</p></li>
<li><p><strong>compresslevel</strong> (<em>int</em>) – if zero, structures are saved as uncompressed <code class="docutils literal notranslate"><span class="pre">.json</span></code>
files, otherwise they are compressed and saved as <code class="docutils literal notranslate"><span class="pre">.json.gz</span></code> files, according
to the desired compression level (1:fast, large file; 9: slow, small file).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of paths to JSON file as a list of <code class="docutils literal notranslate"><span class="pre">{&quot;size&quot;:&lt;natoms&gt;,</span>
<span class="pre">&quot;data&quot;:&lt;filename&gt;}</span></code> records that can be used to create a concise chemiscope
file that references external files as structures</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="jupyter.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Jupyter notebooks</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="cli.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Command line interface</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2020-2026, chemiscope developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">chemiscope</span></code> functions reference</a><ul>
<li><a class="reference internal" href="#input-files">Input files</a><ul>
<li><a class="reference internal" href="#chemiscope.create_input"><code class="docutils literal notranslate"><span class="pre">create_input()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.write_input"><code class="docutils literal notranslate"><span class="pre">write_input()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.quick_settings"><code class="docutils literal notranslate"><span class="pre">quick_settings()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-management">Data management</a><ul>
<li><a class="reference internal" href="#chemiscope.extract_properties"><code class="docutils literal notranslate"><span class="pre">extract_properties()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.all_atomic_environments"><code class="docutils literal notranslate"><span class="pre">all_atomic_environments()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.ellipsoid_from_tensor"><code class="docutils literal notranslate"><span class="pre">ellipsoid_from_tensor()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.arrow_from_vector"><code class="docutils literal notranslate"><span class="pre">arrow_from_vector()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.ase_vectors_to_arrows"><code class="docutils literal notranslate"><span class="pre">ase_vectors_to_arrows()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.ase_tensors_to_ellipsoids"><code class="docutils literal notranslate"><span class="pre">ase_tensors_to_ellipsoids()</span></code></a></li>
<li><a class="reference internal" href="#chemiscope.write_external_structures"><code class="docutils literal notranslate"><span class="pre">write_external_structures()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>